# User Interface
В новой версии приложения анимация котов и элементы пользовательского интерфейса реализованы с помощью Pygame (Pygame-ce, Pygame-GUI). 
Директория состоит из модулей:
- ui — предоставляет главную функцию run_ui, запускающую весь проект;
- resources — предоставляет функции для отрисовки “котов” в двух разных стилях: в виде обычных точек и с помощью изображений;
- cat_drawer — предоставляет функции для непосредственного рисования “котов” в рамках pygame приложения.

ui:
- exit_app — функция для завершения программы: завершает работу процессора (CatProcessor) и закрывает приложение pygame.
- run_ui — функция, запускающая приложение (запуск процессора, получение новых данных, отрисовка котов)

cat_drawer:
- class DrawStyles — класс, содержащий стили рисовки “котов” (точки с разными цветами для каждого состояния или изображения)
- draw_dot — функция для отрисовки “котов” в стиле “точки”
- draw_picture — функция для отрисовки котов в стиле “изображения”
- draw_cats — функция для вычисления интерполированных координат и плавной отрисовки движения котов, препятствий (если есть) и еды.

resources:
- STATE_COLORS — сопоставляет состояниям “котов” цвета для отображения в стиле “точки”
- STATE_PICTURES — сопоставляет состояниям “котов” изображения для отображения в стиле “изображения”
- load_picture — функция для загрузки изображений в память для последующего их переиспользования при отрисовке “котов”
- init_pygame_pictures —  функция для вызова загрузки изображений и сопоставления их состояниям “котов” (а также изображению “еды”)
- catstate_to_color — возвращает цвет, соответствующий определенному состоянию
- catstate_to_picture — возвращает изображение, соответствующее определенному состоянию

# CatProcessor
Для реализации плавной отрисовки и ускорения приложения было принято решение добавить новый модуль CatProcessor. Он отвечает за распараллеливание генератора положений котов и алгоритма, обрабатывающего их. 

Генератор и алгоритмы запущены в разных процессах, общение между ними происходит через специальные очереди. Таким образом получилось реализовать возможность просчёта положения и состояния котов наперёд, не дожидаясь команды от UI.

Основные методы класса CatProcessor:
- start/stop — запуск и остановка обработки 
- data — получить из очереди новый объект CatData
- CatData — класс, хранящий в себе положения котов, их состояния, а также положение еды на карте

# CatGenerator
Остался почти без изменений с предыдущей версии. Были добавлены незначительные оптимизации, а также интерфейс AbstractCatGenerator.
AbstractCatGenerator — содержит все свойства и методы, необходимые для взаимодействия с генератором. Добавлен этот интерфейс был для связи генератора с новым модулем CatProcessor.

# CatAlgorithm
Добавлен интерфейс AbstractAlgo для связи c новым модулем CatProcessor.
Алгоритм основан на [статье](https://docs.taichi-lang.org/blog/acclerate-collision-detection-with-taichi)
Работает по следующему принципу:
Размечает игровое поле, создавая сетку
Подсчитывает число котов в каждой клетке и сохраняет их в списки
С помощью переданной функции считает расстояния между котами (на данный момент реализовано три разных функции)
Обновляет список состояний
